{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://browserbox.dev/schemas/scripts-metadata.schema.json",
  "title": "Scripts Metadata",
  "description": "Schema for scripts/metadata.json in BrowserBox configuration packages",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "id",
      "title",
      "description", 
      "filename"
    ],
    "properties": {
      "id": {
        "type": "string",
        "pattern": "^[a-z0-9-_]+$",
        "minLength": 1,
        "maxLength": 50,
        "description": "Unique identifier for this script"
      },
      "title": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100,
        "description": "Human-readable script name displayed in the UI"
      },
      "description": {
        "type": "string",
        "minLength": 10,
        "maxLength": 500,
        "description": "Detailed explanation of what this script accomplishes"
      },
      "filename": {
        "type": "string",
        "pattern": "^[^<>:\"/\\\\|?*]+\\.py$",
        "description": "Python script filename in the scripts/ directory"
      },
      "category": {
        "type": "string",
        "enum": ["analysis", "visualization", "processing", "reporting", "modeling", "cleaning"],
        "description": "Script category for organization and filtering"
      },
      "fileRequirements": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["filename", "title", "description", "required", "fileType"],
          "properties": {
            "filename": {
              "type": "string",
              "pattern": "^[^<>:\"/\\\\|?*]+\\.[a-z0-9]+$",
              "description": "Exact filename required (used as ID)"
            },
            "title": {
              "type": "string",
              "minLength": 1,
              "maxLength": 100,
              "description": "Human-readable name shown in UI"
            },
            "description": {
              "type": "string",
              "minLength": 10,
              "maxLength": 500,
              "description": "Detailed explanation of file purpose"
            },
            "required": {
              "type": "boolean",
              "description": "Whether this file is mandatory"
            },
            "fileType": {
              "type": "string",
              "pattern": "^\\.[a-z0-9]+$",
              "description": "Required file extension (e.g., '.csv', '.parquet')"
            },
            "maxSize": {
              "type": "number",
              "minimum": 0,
              "description": "Maximum file size in MB"
            },
            "source": {
              "type": "string",
              "enum": ["uploaded", "script"],
              "default": "uploaded",
              "description": "Source of this file: 'uploaded' by user or 'script' generated by another script"
            },
            "producedBy": {
              "type": "string",
              "pattern": "^[a-z0-9-_]+$",
              "description": "Script ID that produces this file (only applicable when source is 'script')"
            }
          },
          "additionalProperties": false
        },
        "description": "File requirements embedded in this script"
      },
      "tags": {
        "type": "array",
        "items": {
          "type": "string",
          "minLength": 1,
          "maxLength": 30
        },
        "maxItems": 10,
        "description": "Tags for searching and filtering scripts"
      },
      "estimatedRuntime": {
        "type": "string",
        "pattern": "^(fast|medium|slow)$",
        "description": "Expected runtime category for user planning"
      }
    },
    "additionalProperties": false
  },
  "examples": [
    [
      {
        "id": "sales-summary",
        "title": "Sales Summary Analysis",
        "description": "Generate comprehensive summary statistics and trends for sales data including revenue, customer counts, and product performance.",
        "filename": "sales_summary.py",
        "category": "analysis",
        "fileRequirements": [
          {
            "filename": "sales_data.csv",
            "title": "Sales Transaction Data",
            "description": "Monthly sales transactions with customer, product, and revenue information",
            "required": true,
            "fileType": ".csv",
            "maxSize": 100,
            "source": "uploaded"
          }
        ],
        "tags": ["sales", "summary", "statistics"],
        "estimatedRuntime": "fast"
      },
      {
        "id": "advanced-forecasting",
        "title": "Sales Forecasting Model",
        "description": "Build and train time series forecasting models using advanced statistical techniques to predict future sales trends.",
        "filename": "forecasting_model.py", 
        "category": "modeling",
        "fileRequirements": [
          {
            "filename": "sales_summary.csv",
            "title": "Sales Summary Data",
            "description": "Cleaned and summarized sales data produced by the sales summary analysis",
            "required": true,
            "fileType": ".csv",
            "source": "script",
            "producedBy": "sales-summary"
          }
        ],
        "tags": ["forecasting", "time-series", "modeling", "advanced"],
        "estimatedRuntime": "slow"
      }
    ]
  ]
}