{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://browserbox.dev/schemas/file-requirements.schema.json",
  "title": "File Requirements",
  "description": "Schema for files/requirements.json in BrowserBox configuration packages",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "id",
      "title", 
      "description",
      "defaultFilename",
      "required"
    ],
    "properties": {
      "id": {
        "type": "string",
        "pattern": "^[a-z0-9-_]+$",
        "minLength": 1,
        "maxLength": 50,
        "description": "Unique identifier for this file requirement"
      },
      "title": {
        "type": "string",
        "minLength": 1,
        "maxLength": 100,
        "description": "Human-readable name displayed in the UI"
      },
      "description": {
        "type": "string",
        "minLength": 10,
        "maxLength": 500,
        "description": "Detailed explanation of what this file should contain"
      },
      "defaultFilename": {
        "type": "string",
        "pattern": "^[^<>:\"/\\\\|?*]+\\.[a-zA-Z0-9]+$",
        "minLength": 1,
        "maxLength": 255,
        "description": "Expected filename including extension"
      },
      "required": {
        "type": "boolean",
        "description": "Whether this file is mandatory for the configuration to work"
      },
      "acceptedTypes": {
        "type": "array",
        "items": {
          "type": "string",
          "pattern": "^\\.[a-z0-9]+$"
        },
        "minItems": 1,
        "maxItems": 20,
        "description": "Allowed file extensions (e.g., [\".csv\", \".parquet\"])"
      },
      "maxSize": {
        "type": "number",
        "minimum": 0.1,
        "maximum": 2000,
        "description": "Maximum file size in megabytes"
      },
      "category": {
        "type": "string",
        "enum": ["data", "config", "reference", "template", "documentation"],
        "description": "Category for organizing file requirements"
      },
      "validation": {
        "type": "object",
        "properties": {
          "minRows": {
            "type": "number",
            "minimum": 0,
            "description": "Minimum number of rows required (for data files)"
          },
          "maxRows": {
            "type": "number",
            "minimum": 0,
            "description": "Maximum number of rows supported (for data files)"
          },
          "requiredColumns": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Column names that must be present (for structured data)"
          },
          "encoding": {
            "type": "string",
            "enum": ["utf-8", "latin1", "ascii"],
            "default": "utf-8",
            "description": "Expected text encoding"
          }
        },
        "additionalProperties": false
      },
      "examples": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Example file contents or structure descriptions"
      },
      "dependencies": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "IDs of other file requirements this file depends on"
      }
    },
    "additionalProperties": false
  },
  "examples": [
    [
      {
        "id": "sales_data",
        "title": "Sales Transaction Data",
        "description": "Monthly sales transactions with customer, product, and revenue information. Should contain columns: date, customer_id, product_id, quantity, revenue.",
        "defaultFilename": "sales_transactions.csv",
        "required": true,
        "acceptedTypes": [".csv", ".parquet"],
        "maxSize": 200,
        "category": "data",
        "validation": {
          "minRows": 1,
          "requiredColumns": ["date", "customer_id", "product_id", "revenue"],
          "encoding": "utf-8"
        },
        "examples": [
          "date,customer_id,product_id,quantity,revenue\\n2025-01-01,C001,P001,2,150.00"
        ]
      },
      {
        "id": "customer_metadata",
        "title": "Customer Demographics", 
        "description": "Optional customer information for enhanced analysis including demographics and segmentation data.",
        "defaultFilename": "customers.csv",
        "required": false,
        "acceptedTypes": [".csv", ".xlsx"],
        "maxSize": 50,
        "category": "reference",
        "dependencies": ["sales_data"]
      }
    ]
  ]
}